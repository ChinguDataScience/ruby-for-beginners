<!DOCTYPE html>
<!--[if lt IE 7]>      <html class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]-->
<!--[if IE 7]>         <html class="no-js lt-ie9 lt-ie8"> <![endif]-->
<!--[if IE 8]>         <html class="no-js lt-ie9"> <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js"> <!--<![endif]-->
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="description" content="Ruby for Beginners">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="google-site-verification" content="BEd2YAbpSQrRqU2-5wUifTTzvqTMGLLE269b0JZTfCs" />

    <title>Block return values | Ruby for Beginners</title>

    <link href="../assets/stylesheets/monstas-29ea5021.css" rel="stylesheet" type="text/css" />
  </head>

  <body>
    <nav class="page-nav"><a href="/12-blocks/02-block_arguments.html" class="prev">Previous</a></nav>
    <nav class="page-nav"><a href="/13-bonus_1.html" class="next">Next</a></nav>

    <div>
      <nav class="toc">
        <h1>Contents</h1>
        <ul>
  <li><a href="/index.html">Ruby For Beginners</a></li>
  <li><a href="/01-preface.html">Preface</a></li>
  <li><a href="/02-creation.html">Programming is creation</a></li>
  <li class="directory"><a href="/03-learning_to_program.html">Learning to program</a>
  <ul>
      <li><a href="/03-learning_to_program/01-learning_modes.html">Learning modes</a></li>
      <li><a href="/03-learning_to_program/02-dont_believe.html">Don&rsquo;t believe everything we say</a></li>
      <li><a href="/03-learning_to_program/03-formatting_code.html">Formatting your code</a></li>
      <li><a href="/03-learning_to_program/04-error_messages.html">Reading error messages</a></li>
      <li><a href="/03-learning_to_program/05-using_google.html">Using Google</a></li>
  </ul></li>
  <li class="directory"><a href="/04-your_tools.html">Your tools</a>
  <ul>
      <li><a href="/04-your_tools/01-text_editor.html">Text Editor</a></li>
      <li><a href="/04-your_tools/02-terminal.html">Terminal</a></li>
      <li><a href="/04-your_tools/03-ruby_runtime.html">Ruby runtime</a></li>
      <li><a href="/04-your_tools/04-workflow.html">Programming workflow</a></li>
      <li><a href="/04-your_tools/05-irb.html">Interactive Ruby</a></li>
  </ul></li>
  <li><a href="/05-object_oriented_programming.html">Object-oriented programming</a></li>
  <li class="directory"><a href="/06-built_in_classes.html">Built-in classes</a>
  <ul>
      <li><a href="/06-built_in_classes/01-numbers.html">Numbers</a></li>
      <li><a href="/06-built_in_classes/02-strings.html">Strings</a></li>
      <li><a href="/06-built_in_classes/03-symbols.html">Symbols</a></li>
      <li><a href="/06-built_in_classes/04-arrays.html">Arrays</a></li>
      <li><a href="/06-built_in_classes/05-hashes.html">Hashes</a></li>
  </ul></li>
  <li><a href="/07-variables.html">Variables</a></li>
  <li class="directory"><a href="/08-methods.html">Methods</a>
  <ul>
      <li><a href="/08-methods/01-return_values.html">Return values</a></li>
      <li><a href="/08-methods/02-parentheses.html">Parentheses</a></li>
      <li><a href="/08-methods/03-writing_methods.html">Writing a new method</a></li>
      <li><a href="/08-methods/04-control_flow.html">Flow of execution</a></li>
      <li><a href="/08-methods/05-scopes.html">Scopes</a></li>
      <li><a href="/08-methods/06-printing.html">Printing things</a></li>
  </ul></li>
  <li class="directory"><a href="/09-everything_an_object.html">Everything is an object</a>
  <ul>
      <li><a href="/09-everything_an_object/01-object_classes.html">Objects have classes</a></li>
      <li><a href="/09-everything_an_object/02-object_methods.html">Calling methods</a></li>
  </ul></li>
  <li><a href="/10-string_interpolation.html">String interpolation</a></li>
  <li><a href="/11-nothing_and_truth.html">Nothingness and the truth</a></li>
  <li class="directory expanded"><a href="/12-blocks.html">Blocks</a>
  <ul>
      <li><a href="/12-blocks/01-block_syntax.html">Alternative block syntaxes</a></li>
      <li><a href="/12-blocks/02-block_arguments.html">Block arguments</a></li>
      <li class="active"><a href="/12-blocks/03-block_return_values.html">Block return values</a></li>
  </ul></li>
  <li class="directory"><a href="/13-bonus_1.html">Bonus: Methods &amp; Operators</a>
  <ul>
      <li><a href="/13-bonus_1/01-operator_methods.html">Operators are methods</a></li>
      <li><a href="/13-bonus_1/02-predicate_methods.html">Predicate methods</a></li>
      <li><a href="/13-bonus_1/03-other_methods.html">Lots of other methods</a></li>
      <li><a href="/13-bonus_1/04-questions_commands.html">Questions and commands</a></li>
      <li><a href="/13-bonus_1/05-conditionals.html">Conditionals</a></li>
      <li><a href="/13-bonus_1/06-operators.html">Operators</a></li>
      <li><a href="/13-bonus_1/07-arithmetical_operators.html">Arithmetical operators</a></li>
      <li><a href="/13-bonus_1/08-logical_operators.html">Logical operators</a></li>
      <li><a href="/13-bonus_1/09-comparison_operators.html">Comparison operators</a></li>
  </ul></li>
  <li class="directory"><a href="/14-writing_classes.html">Writing classes</a>
  <ul>
      <li><a href="/14-writing_classes/01-initializing_objects.html">Initializing objects</a></li>
      <li><a href="/14-writing_classes/02-instance_variables.html">Instance variables</a></li>
      <li><a href="/14-writing_classes/03-attribute_readers.html">Attribute readers</a></li>
      <li><a href="/14-writing_classes/04-attribute_writers.html">Attribute writers</a></li>
      <li><a href="/14-writing_classes/05-state_and_behaviour.html">State and behaviour</a></li>
  </ul></li>
  <li class="directory"><a href="/15-bonus_2.html">Bonus: Advanced Topics</a>
  <ul>
      <li><a href="/15-bonus_2/01-libraries.html">Bonus: Using Libraries</a></li>
      <li><a href="/15-bonus_2/02-modules.html">Bonus: Modules</a></li>
      <li><a href="/15-bonus_2/03-private_methods.html">Bonus: Private methods</a></li>
  </ul></li>
  <li><a href="/16-good_names.html">Using the right words</a></li>
  <li class="directory"><a href="/17-exercises.html">Exercises</a>
  <ul>
      <li><a href="/17-exercises/01-numbers.html">Working with Numbers</a></li>
      <li><a href="/17-exercises/02-strings.html">Working with Strings</a></li>
      <li><a href="/17-exercises/03-arrays_1.html">Working with Arrays (1)</a></li>
      <li><a href="/17-exercises/04-hashes_1.html">Working with Hashes (1)</a></li>
      <li><a href="/17-exercises/05-methods_1.html">Defining methods</a></li>
      <li><a href="/17-exercises/06-arrays_2.html">Working with Arrays (2)</a></li>
      <li><a href="/17-exercises/07-nested_arrays.html">Working with Nested Arrays</a></li>
      <li><a href="/17-exercises/08-hashes_2.html">Working with Hashes (2)</a></li>
      <li><a href="/17-exercises/09-truthiness.html">Truthiness</a></li>
      <li><a href="/17-exercises/10-email.html">The Email Class</a></li>
      <li><a href="/17-exercises/11-mailbox.html">The Mailbox Class</a></li>
      <li><a href="/17-exercises/12-mailbox_text.html">The Mailbox Text Formatter</a></li>
      <li><a href="/17-exercises/13-mailbox_html.html">The Mailbox Html Formatter</a></li>
      <li><a href="/17-exercises/14-mailbox_file.html">Storing our HTML to a File</a></li>
      <li><a href="/17-exercises/15-mailbox_csv.html">Reading from a CSV File</a></li>
      <li><a href="/17-exercises/16-mailbox_erb.html">Generating HTML using ERB</a></li>
      <li><a href="/17-exercises/17-mailbox_sinatra.html">Serving HTML using Sinatra</a></li>
  </ul></li>
</ul>
      </nav>
      <article>
        <nav class="menu"><a href="#"></a></nav>
        <h1>Block return values</h1>

<p>Remember that we said a block returns a value just like methods do?  So far, in
our two examples above, we did not do anything with the return values of the
block.</p>

<p>Here&rsquo;s an example that does that:</p>
<pre class="highlight ruby"><code><span class="nb">p</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">].</span><span class="nf">collect</span> <span class="p">{</span> <span class="o">|</span><span class="n">number</span><span class="o">|</span> <span class="n">number</span> <span class="o">+</span> <span class="mi">1</span> <span class="p">}</span>
</code></pre>

<p>This will take the array of numbers, and transform it into <em>another</em> array.</p>

<p>It does this by calling the method <code>collect</code> on the original array, which calls
the given block for each of the elements, and collects each of the return
values returned by the block. The resulting array is then returned by the
method <code>collect</code>, and printed to the screen.</p>

<p>In other words, the method <code>collect</code> uses the block as a transformer. It takes
each element of the array, passes it to the block in order to transform it
to something else, and then keeps all the transformed values in a <em>new</em> array
that the method <code>collect</code> then eventually returns.</p>

<p>Note that the method <code>collect</code> has an alias, which is <code>map</code>. These are exactly
the same methods. Many programmers prefer <code>map</code> over <code>collect</code> because it is
shorter, and also more commonly used in other languages. However, in our study
groups we use <code>collect</code> more often, because it simply expresses more clearly
what the method does.</p>

<p>Here&rsquo;s another example that uses the return value of the block, can you guess
what it does?</p>
<pre class="highlight ruby"><code><span class="nb">p</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">].</span><span class="nf">select</span> <span class="p">{</span> <span class="o">|</span><span class="n">number</span><span class="o">|</span> <span class="n">number</span><span class="p">.</span><span class="nf">odd?</span> <span class="p">}</span>
</code></pre>

<p>In this case, the method <code>select</code> uses the block in a different way: as a
filter, or criterion, to select values out of the array, and then return a new
array with the selected values.</p>

<p>Let&rsquo;s walk through this step by step, under the microscope:</p>

<ul>
<li>We create an array <code>[1, 2, 3, 4, 5]</code>.</li>
<li>We then call the method <code>select</code> on it, and pass our block as a filter
criterion.</li>
<li>Now, the method <code>select</code> calls our block for each of the numbers.</li>
<li>It first calls the block passing the number <code>1</code>.</li>
<li>We now are inside the block, and a local variable <code>number</code> is assigned the
object that was passed as an argument, which is the number <code>1</code>.</li>
<li>Inside our block we now call the method <code>odd?</code> on this number, and of course,
because <code>1</code> is odd, this will return <code>true</code>.</li>
<li>Since this is the only, and thus, last statement in the body of our block,
our block also returns <code>true</code> to the method <code>select</code>. <code>select</code> therefore will
<em>keep</em> (&ldquo;select&rdquo;) the number <code>1</code>.</li>
<li>It then calls the block again, this time passing the number <code>2</code>. Of course,
because this is not an odd number, the method <code>odd?</code> and therfore our block
will return <code>false</code> back the the method <code>select</code>. Therefore it <em>discards</em> this
element.</li>
<li>It keeps doing this for each of the remaining elements in the array, and
eventually has this array: <code>[1, 3, 5]</code></li>
<li>The method <code>select</code> then returns this array and Ruby will pass it to the
method <code>p</code>, which prints the array out to the screen.</li>
</ul>

<p>Thus, the code above prints out <code>[1, 3, 5]</code>.</p>

<p>Here&rsquo;s another example of a method that uses the block as a criterion:</p>
<pre class="highlight ruby"><code><span class="nb">p</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">].</span><span class="nf">detect</span> <span class="p">{</span> <span class="o">|</span><span class="n">number</span><span class="o">|</span> <span class="n">number</span><span class="p">.</span><span class="nf">even?</span> <span class="p">}</span>
</code></pre>

<p>Again, <code>detect</code> will pass each of the elements of the array to the block, one
by one, and check the return value of the block. However, as soon as the block
returns something truthy (something that is &ldquo;equivalent to true&rdquo;), the method
<code>detect</code> will return the current object itself. Therefore, this will print out
<code>2</code>: the first number in the array that is even.</p>

<h4>Inversion of control</h4>

<p>In Ruby there are a lot more methods that accept blocks, and they do very
different things.</p>

<p>However, they have one thing in common: By accepting a block, from
you as a programmer, the method can pass control to you. This principle is
called &ldquo;inversion of control&rdquo;.</p>

<p>For example, instead of having to define lots of methods like <code>select_odd</code>,
<code>select_even</code>, <code>select_lesser_than</code>, <code>select_greater_than</code> and so on, defining
one method per potentially useful criterion, Ruby only has to implement one
single, generic method for arrays: <code>select</code>, allowing you to flexibly specify
the criterion in form of Ruby code: by passing a block to the
method. That way Ruby lets you, as a programmer, take over control, and specify
what is used as a criterion to select elements.</p>

<h4>Iterators</h4>

<p>Methods on arrays and hashes that take a block are also called iterators.
We say they &ldquo;iterate over the array&rdquo;, meaning that these methods take each
element of the array and do something with it.</p>

<p>In Ruby iterators are &ldquo;chainable&rdquo;, adding functionality on top of each other.
That means that, if you do not pass a block to an iterator method, such as
<code>each</code>, <code>collect</code>, <code>select</code>, then you&rsquo;ll get an iterator object back. You can
then call more methods on these iterator objects, and finally pass a block.
Like so:</p>
<pre class="highlight ruby"><code><span class="n">numbers</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">].</span><span class="nf">collect</span><span class="p">.</span><span class="nf">with_index</span> <span class="k">do</span> <span class="o">|</span><span class="n">number</span><span class="p">,</span> <span class="n">index</span><span class="o">|</span>
  <span class="n">number</span> <span class="o">+</span> <span class="n">index</span>
<span class="k">end</span>
<span class="nb">p</span> <span class="n">numbers</span>
</code></pre>

<p>This will print out:</p>
<pre class="highlight plaintext"><code>[1, 3, 5, 7, 9]
</code></pre>

<p>What&rsquo;s going on here?</p>

<p>The method <code>with_index</code> can be called on any iterator object. All it does is
pass the index of the element within the array to the block, as a second block
argument, in addition to the element itself.</p>

<p>Inside of the block we can then use it, and add the index to the number itself.</p>

<p>For the first iteration it will call the block with <code>1</code> and <code>0</code>, since <code>0</code> is
the first &ldquo;position&rdquo;, that is, index. It therefore returns <code>1</code>. For the second
iteration it calls the block with <code>2</code> and <code>1</code>, and returns <code>3</code>, and so on.</p>

        <nav class="page-nav"><a href="/12-blocks/02-block_arguments.html" class="prev">Previous</a></nav>
        <nav class="page-nav"><a href="/13-bonus_1.html" class="next">Next</a></nav>
      </article>
    </div>

    <footer>
      <ul>
        <li><a href="http://rubymonstas.org">Ruby Monstas</a></li>
        <li><a href="mailto:ruby.monsters@gmail.com">Email</a></li>
        <li><a href="https://twitter.com/rubymonsters">Twitter</a></li>
        <li><a href="https://github.com/rubymonsters">GitHub</a></li>
        <li><a href="https://creativecommons.org/licenses/by-sa/2.0/" rel="license cc:license">License</a></li>
        <li><a href="http://foundation.travis-ci.org/imprint/">Imprint</a></li>
      </ul>
    </footer>

    <script src="../assets/javascripts/modernizr-4c875d94.js" type="text/javascript"></script>
    <script src="../assets/javascripts/monstas-e84d6217.js" type="text/javascript"></script>
  </body>
</html>
